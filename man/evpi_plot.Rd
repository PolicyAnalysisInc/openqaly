% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/psa_plots.R
\name{evpi_plot}
\alias{evpi_plot}
\title{Plot Expected Value of Perfect Information (EVPI)}
\usage{
evpi_plot(
  results,
  outcome_summary = NULL,
  cost_summary = NULL,
  wtp_range = c(0, 1e+05),
  wtp_step = 5000,
  groups = "overall",
  strategies = NULL,
  title = NULL,
  xlab = "Willingness to Pay",
  ylab = "Expected Value of Perfect Information",
  legend_position = "bottom"
)
}
\arguments{
\item{results}{A openqaly PSA results object, or pre-calculated EVPI data
from calculate_evpi()}

\item{outcome_summary}{Name of the outcome summary (required if results is
a model object)}

\item{cost_summary}{Name of the cost summary (required if results is a
model object)}

\item{wtp_range}{Numeric vector with min and max WTP values for x-axis.
Default is c(0, 100000)}

\item{wtp_step}{Step size for WTP thresholds. Default is 5000}

\item{groups}{Group selection: "overall" (default) uses overall/aggregated results,
"all" includes overall + all groups, "all_groups" includes all groups without overall,
specific group name(s) filter to those groups (triggers faceting by group)}

\item{strategies}{Character vector of strategy names to include (NULL for all)}

\item{title}{Plot title. If NULL, auto-generated}

\item{xlab}{X-axis label. Default is "Willingness to Pay"}

\item{ylab}{Y-axis label. Default is "Expected Value of Perfect Information"}

\item{legend_position}{Legend position: "bottom" (default), "right", "top",
"left", or "none"}
}
\value{
A ggplot2 object
}
\description{
Creates a line plot showing how EVPI changes across different willingness-to-pay
thresholds. EVPI represents the expected value of eliminating all parameter
uncertainty.
}
\details{
The EVPI plot shows how the expected value of eliminating all parameter
uncertainty changes with the willingness-to-pay threshold. Higher EVPI values
indicate greater decision uncertainty and potentially higher value of
conducting additional research.

EVPI = 0 indicates that the same strategy is optimal in all PSA simulations,
meaning parameter uncertainty does not affect the optimal decision at that
WTP threshold.

EVPI calculations always use discounted values as this is a cost-effectiveness measure.

When multiple groups are present, the plot is automatically faceted by group
using \code{facet_wrap(~ group, scales = "fixed")}.
}
\examples{
\dontrun{
model <- read_model(system.file("models/example_psm", package = "openqaly"))
psa_results <- run_psa(model, n_sim = 1000)

# Basic EVPI plot
evpi_plot(psa_results, "total_qalys", "total_cost")

# Custom WTP range
evpi_plot(psa_results, "total_qalys", "total_cost",
          wtp_range = c(0, 200000), wtp_step = 10000)

# With custom title
evpi_plot(psa_results, "total_qalys", "total_cost",
          title = "EVPI Analysis for Treatment Decision")
}

}
