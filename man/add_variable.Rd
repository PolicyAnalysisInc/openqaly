% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/model_builder.R
\name{add_variable}
\alias{add_variable}
\title{Add Variables to Model}
\usage{
add_variable(
  model,
  name,
  formula,
  display_name = NULL,
  description = NULL,
  strategy = "",
  group = "",
  source = "",
  sampling
)
}
\arguments{
\item{model}{A heRomodel_builder object}

\item{name}{Character string for the variable name}

\item{formula}{An unquoted R expression for the variable calculation}

\item{display_name}{Optional display name. If not provided, will be auto-generated
from name, strategy, and group. You can override with a custom name if desired.}

\item{description}{Optional description}

\item{strategy}{Optional strategy association}

\item{group}{Optional group association}

\item{source}{Optional source information}

\item{sampling}{Optional sampling information}
}
\value{
The modified model object
}
\description{
Add one or more variables to the model. Uses NSE to capture formula expressions.
}
\details{
**Display Names**: The `display_name` parameter is optional. If not provided, display names
are automatically generated based on the variable name, strategy, and group:
- No strategy/group: `"var_name"`
- Strategy only: `"var_name, strategy_name"`
- Group only: `"var_name, group_name"`
- Both: `"var_name, strategy_name, group_name"`

This auto-generation ensures unique display names for strategy/group-specific variables,
which is important for DSA/PSA plots and tables.

**Important**: When a variable has multiple definitions (e.g., one per strategy/group), if you
provide a custom `display_name` for at least one definition, you must provide it for ALL definitions
of that variable. Mixing custom and auto-generated display names for the same variable will result
in a validation error **immediately** when you call `add_variable()` with the inconsistent definition.
}
\examples{
model <- define_model("markov") |>
  add_variable("p_disease", look_up(table, age = cohort_age))

# Strategy-specific variables - display names auto-generated
model <- model |>
  add_variable("cost_med", strategy = "treatment_a", formula = 5000,
               sampling = normal(5000, 500)) |>
  add_variable("cost_med", strategy = "treatment_b", formula = 3000,
               sampling = normal(3000, 300))
# Auto-generates: "cost_med, treatment_a" and "cost_med, treatment_b"

# Or provide custom display names if preferred
model <- model |>
  add_variable("cost_med", display_name = "Treatment A Cost",
               strategy = "treatment_a", formula = 5000) |>
  add_variable("cost_med", display_name = "Treatment B Cost",
               strategy = "treatment_b", formula = 3000)
}
