% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/psa_plots.R
\name{nmb_density_plot}
\alias{nmb_density_plot}
\title{Net Monetary Benefit Density Plot}
\usage{
nmb_density_plot(
  results,
  outcome_summary,
  cost_summary,
  wtp,
  groups = "overall",
  strategies = NULL,
  show_mean = TRUE,
  alpha = 0.4,
  title = NULL,
  xlab = NULL,
  legend_position = "right"
)
}
\arguments{
\item{results}{A openqaly PSA results object}

\item{outcome_summary}{Name of the outcome summary (e.g., "total_qalys")}

\item{cost_summary}{Name of the cost summary (e.g., "total_cost")}

\item{wtp}{Willingness-to-pay threshold for NMB calculation}

\item{groups}{Group selection:
\itemize{
  \item \code{"overall"} - Overall population (aggregated, default)
  \item \code{"group_name"} - Specific group by name
  \item \code{c("group1", "group2")} - Multiple specific groups (no overall)
  \item \code{c("overall", "group1")} - Specific groups + overall
  \item \code{"all"} or \code{NULL} - All groups + overall
  \item \code{"all_groups"} - All groups without overall
}}

\item{strategies}{Character vector of strategies to include (NULL for all)}

\item{show_mean}{Logical. Show vertical lines at mean NMB per strategy?}

\item{alpha}{Transparency for density fill (default: 0.4)}

\item{title}{Optional plot title}

\item{xlab}{Optional x-axis label}

\item{legend_position}{Legend position ("right", "bottom", "top", "left", "none")}
}
\value{
A ggplot object
}
\description{
Creates a density plot showing the distribution of Net Monetary Benefit (NMB)
by strategy at a given willingness-to-pay threshold.
}
\details{
Net Monetary Benefit is calculated as:
\deqn{NMB = \lambda \times Outcomes - Costs}

where \eqn{\lambda} is the willingness-to-pay threshold. Higher NMB indicates
better value. The density plot shows the full distribution of NMB values
across all PSA simulations, providing insight into the uncertainty around
each strategy's value.

NMB calculations always use discounted values as this is a cost-effectiveness measure.
}
\examples{
\dontrun{
model <- read_model(system.file("models/example_psm", package = "openqaly"))
psa_results <- run_psa(model, n_sim = 1000)

# NMB density at WTP = $50,000
nmb_density_plot(psa_results, "total_qalys", "total_cost", wtp = 50000)

# With custom styling
nmb_density_plot(psa_results, "total_qalys", "total_cost",
                 wtp = 100000, show_mean = TRUE, alpha = 0.5)
}

}
