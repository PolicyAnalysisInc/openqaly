% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/dsa_plots.R
\name{dsa_nmb_plot}
\alias{dsa_nmb_plot}
\title{Plot DSA Net Monetary Benefit as Tornado Diagram}
\usage{
dsa_nmb_plot(
  results,
  health_outcome,
  cost_outcome,
  group = "aggregated",
  wtp = NULL,
  interventions = NULL,
  comparators = NULL,
  discounted = FALSE,
  show_parameter_values = TRUE,
  drop_zero_impact = TRUE
)
}
\arguments{
\item{results}{A heRomod2 DSA results object (output from run_dsa)}

\item{health_outcome}{Name of the health outcome summary to use (e.g., "total_qalys")}

\item{cost_outcome}{Name of the cost summary to use (e.g., "total_cost")}

\item{group}{Group selection: "aggregated" (default), specific group name, or NULL
(all groups plus aggregated)}

\item{wtp}{Optional override for willingness-to-pay. If NULL, extracts from outcome summary metadata.}

\item{interventions}{Character vector of intervention strategy name(s) (e.g., "new_treatment").
Can be a single value or vector. Can be combined with comparators for N×M comparisons.
At least one of interventions or comparators must be specified.}

\item{comparators}{Character vector of comparator strategy name(s) (e.g., "control").
Can be a single value or vector. Can be combined with interventions for N×M comparisons.
At least one of interventions or comparators must be specified.}

\item{discounted}{Logical. Use discounted values? (default: FALSE)}

\item{show_parameter_values}{Logical. Include parameter values in Y-axis labels? (default: TRUE)
When TRUE, labels show "Parameter Name (low - high)" format with evaluated parameter values.}

\item{drop_zero_impact}{Logical. Remove parameters with zero impact on NMB? (default: TRUE)
A parameter has zero impact when its NMB range is effectively zero.}
}
\value{
A ggplot2 object
}
\description{
Creates a tornado plot showing the impact of varying each DSA parameter on
Net Monetary Benefit (NMB). NMB = (Difference in Outcomes × WTP) - Difference in Costs.
Shows horizontal bars representing the range of NMB variation with a vertical line at
the base case.
}
\details{
The NMB tornado plot displays each DSA parameter as a horizontal bar showing the range
of Net Monetary Benefit from low to high parameter value. Parameters are sorted by the
magnitude of their impact (largest range first). A vertical line indicates the base case NMB.

**Comparison Requirements:**

Unlike dsa_outcomes_plot, NMB always requires comparing strategies. At least one of
interventions or comparators must be specified.

**Comparison Modes:**

- Both as single values: shows one comparison (interventions - comparators)
- One as vector, other NULL: shows each vs. all others
  - interventions=c(A,B), comparators=NULL: A vs. all others, B vs. all others
  - comparators=c(C,D), interventions=NULL: all others vs. C, all others vs. D
- Both as vectors (N×M mode): shows all pairwise comparisons (excluding self-comparisons)
  - interventions=c(A,B), comparators=c(C,D): A vs. C, A vs. D, B vs. C, B vs. D

Faceting follows the standard pattern:
- Multiple comparisons only: facet_wrap(~ strategy)
- Multiple groups only: facet_wrap(~ group)
- Both: facet_grid(group ~ strategy)
- Single: no faceting
}
\examples{
\dontrun{
model <- define_model("markov") \%>\%
  add_variable("p_disease", 0.03) \%>\%
  add_dsa_variable("p_disease", low = 0.01, high = 0.05)
dsa_results <- run_dsa(model)

# NMB tornado plot (comparator perspective)
dsa_nmb_plot(dsa_results, "total_qalys", "total_cost", comparators = "control")

# NMB with explicit WTP (intervention perspective)
dsa_nmb_plot(dsa_results, "total_qalys", "total_cost",
             interventions = "new_treatment", wtp = 50000)

# N×M comparisons
dsa_nmb_plot(dsa_results, "total_qalys", "total_cost",
             interventions = c("treatment_a", "treatment_b"),
             comparators = c("control", "standard_care"))
}

}
