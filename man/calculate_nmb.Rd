% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/values_output.R
\name{calculate_nmb}
\alias{calculate_nmb}
\title{Calculate Net Monetary Benefit}
\usage{
calculate_nmb(
  results,
  outcome_summary,
  cost_summary,
  groups = "overall",
  interventions = NULL,
  comparators = NULL,
  wtp = NULL,
  use_display_names = TRUE,
  return_components = FALSE
)
}
\arguments{
\item{results}{A openqaly model results object (output from run_model)}

\item{outcome_summary}{Name of the outcome summary (e.g., "total_qalys")}

\item{cost_summary}{Name of the cost summary (e.g., "total_cost")}

\item{groups}{Group selection: "overall" (default), specific group name, vector of groups, or NULL}

\item{interventions}{Character vector of reference strategies for intervention perspective (e.g., "new_treatment").
If provided, shows intervention - comparator comparisons. Mutually exclusive with comparators.}

\item{comparators}{Character vector of reference strategies for comparator perspective (e.g., "control").
If provided, shows intervention - comparator comparisons. Mutually exclusive with interventions.}

\item{wtp}{Optional override for willingness-to-pay value. If NULL, attempts to extract from
outcome summary metadata. Must be numeric and positive.}

\item{use_display_names}{Logical. If TRUE (default), use display names for entities}

\item{return_components}{Logical. If TRUE, returns breakdown of Outcome Benefit,
Cost Difference, and Total. If FALSE (default), returns only total NMB.}
}
\value{
A data frame with columns:
  - If return_components = FALSE: strategy, group, nmb_amount
  - If return_components = TRUE: strategy, group, component, amount
    where component is one of "Outcome Benefit", "Cost Difference", "Total"
}
\description{
Calculates Net Monetary Benefit (NMB) as: (Difference in Outcomes × WTP) - Difference in Costs
Requires comparison between strategies using either intervention or comparator.
}
\details{
One of `intervention` or `comparator` must be provided. The function calculates NMB as:
- When intervention specified: (intervention_outcome - other_outcome) × WTP - (intervention_cost - other_cost)
- When comparator specified: (other_outcome - comparator_outcome) × WTP - (other_cost - comparator_cost)

WTP is automatically extracted from the outcome summary metadata if available,
but can be overridden using the `wtp` parameter.
}
\examples{
\dontrun{
model <- read_model(system.file("models/example_psm", package = "openqaly"))
results <- run_model(model)

# Calculate NMB with WTP from metadata
nmb <- calculate_nmb(
  results,
  outcome_summary = "total_qalys",
  cost_summary = "total_cost",
  comparator = "control"
)

# Calculate NMB with explicit WTP override
nmb <- calculate_nmb(
  results,
  outcome_summary = "total_qalys",
  cost_summary = "total_cost",
  intervention = "new_treatment",
  wtp = 50000
)
}

}
